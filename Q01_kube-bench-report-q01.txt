# kube-bench (SIMULATED) â€” CIS Kubernetes Benchmark v1.8.x
# Target: kubeadm-provisioned control-plane node
# Date: $(date -Is)
#
# NOTE: This file is intentionally generated by the lab setup to represent the findings
# a CIS scan would flag before remediation.

[INFO] 1 Control Plane Security Configuration
[INFO] 2 Etcd Node Configuration
[INFO] 3 Control Plane Configuration
[INFO] 4 Worker Node Security Configuration

[INFO] 4 Worker Node Security Configuration
[INFO] 4.2 Kubelet
[FAIL] 4.2.1 Ensure that the --anonymous-auth argument is set to false (Automated)
       * Reason: kubelet flag --anonymous-auth is true
       * Remediation: Edit kubelet args to include --anonymous-auth=false and restart kubelet

[FAIL] 4.2.2 Ensure that the --authorization-mode argument is not set to AlwaysAllow (Automated)
       * Reason: kubelet flag --authorization-mode=AlwaysAllow
       * Remediation: Set --authorization-mode to a secure option such as Webhook or Node,RBAC and restart kubelet

[FAIL] 4.2.5 Ensure that the --authentication-token-webhook argument is set to true (Automated)
       * Reason: kubelet flag --authentication-token-webhook is false
       * Remediation: Set --authentication-token-webhook=true and restart kubelet

[INFO] 2 Etcd Node Configuration
[INFO] 2.2 Etcd Node Configuration Files
[FAIL] 2.2.4 Ensure that the --client-cert-auth argument is set to true (Automated)
       * Reason: etcd flag --client-cert-auth is false
       * Remediation: Set --client-cert-auth=true in /etc/kubernetes/manifests/etcd.yaml and allow static pod to restart

== Summary ==
1 checks PASS
0 checks WARN
4 checks FAIL
